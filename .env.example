# ========================================
# EduPath Platform - Environment Configuration Template
# ========================================
# Copy this file to .env or .env.local and fill in your values

# ========================================
# Environment
# ========================================
NODE_ENV=development

# ========================================
# Database (Required)
# ========================================
DATABASE_URL=postgresql://user:password@host:5432/database

# ========================================
# Security Secrets (Required)
# ========================================
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your-jwt-secret-min-64-characters-CHANGE-IN-PRODUCTION

# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
CSRF_SECRET=your-csrf-secret-min-32-characters-CHANGE-IN-PRODUCTION

# Trust Proxy Configuration - Critical for secure IP detection and rate limiting
# Set to the number of proxies between clients and your server
# - false or 0: No proxy (direct connection to clients)
# - 1: Behind single proxy (AWS Lightsail, Heroku, most cloud platforms)
# - 2+: Behind multiple proxies (CDN + load balancer, etc.)
# WARNING: Setting this incorrectly allows IP spoofing and rate limit bypass!
TRUST_PROXY=1

# ========================================
# Feature Flags - Production Features
# ========================================
# Control which production features are enabled (testable in any environment)

# SEO & Meta Tags - Inject SEO meta tags into HTML pages
SEO_META_ENABLED=true

# Security & Redirects - HTTPS and canonical URL enforcement
FORCE_HTTPS_REDIRECT=false
CANONICAL_URL_ENFORCEMENT=false

# Monitoring & Compliance - Performance monitoring and compliance tracking
MONITORING_ENABLED=true
COMPLIANCE_REPORT_ENABLED=true

# Error Handling - Show detailed error messages (disable in production)
ERROR_DETAILS_ENABLED=true

# ========================================
# Logging Configuration
# ========================================
# LOG_LEVEL: error, warn, info, debug
LOG_LEVEL=debug

# LOG_FORMAT: pretty (development) or json (production)
LOG_FORMAT=pretty

# LOG_FILE_ENABLED: Enable file logging
LOG_FILE_ENABLED=true

# ========================================
# CORS Configuration (for split deployments)
# ========================================
# Enable CORS only when frontend and backend are on different domains
CORS_ENABLED=false

# Maximum age for CORS preflight cache (in seconds)
CORS_MAX_AGE=86400

# Comma-separated list of allowed origins
ALLOWED_ORIGINS=http://localhost:5000,http://localhost:5173

# ========================================
# Cookie Configuration
# ========================================
# COOKIE_SECURE: Require HTTPS for cookies (true in production)
COOKIE_SECURE=false

# COOKIE_SAMESITE: strict, lax, or none (use 'none' for cross-origin)
COOKIE_SAMESITE=lax

# ========================================
# Build Configuration (Development Tools)
# ========================================
# These options have smart defaults and typically don't need to be set manually:
#
# HMR_ENABLED - Hot Module Replacement for instant updates
#   Default: true (enabled) for fast development, false on Replit
#   Only override if you need to disable HMR locally
#
# IMAGE_OPTIMIZATION_ENABLED - Optimize images during builds
#   Default: false (disabled for fast dev builds)
#   Set to 'true' for production builds to enable image minification
#
# CARTOGRAPHER_ENABLED - Replit's code navigation and debugging tool
#   Default: auto-enabled on Replit, disabled elsewhere
#   Only override if you need to force enable/disable
#
# Uncomment and set these only if you need to override the smart defaults:
# HMR_ENABLED=false
# IMAGE_OPTIMIZATION_ENABLED=true
# CARTOGRAPHER_ENABLED=true

# ========================================
# Optional Services
# ========================================
# Email Service (Optional)
SENDGRID_API_KEY=your-sendgrid-api-key

# Admin Account (Optional - default password generated if not set)
ADMIN_PASSWORD=your-secure-admin-password

# CSRF Metrics (Optional - for debugging CSRF issues)
CSRF_METRICS_ENABLED=false

# ========================================
# Optional: CSRF Configuration
# ========================================
# Enable during migration period to accept both old and new token formats
# CSRF_DUAL_MODE=true

# ========================================
# Optional: Admin Configuration
# ========================================
# Comma-separated list of IPs to bypass rate limiting
# ADMIN_IPS=127.0.0.1,192.168.1.100

# ========================================
# Deployment Examples
# ========================================

# --- Development (Monolithic - Same Origin) ---
# NODE_ENV=development
# CORS_ENABLED=false
# FORCE_HTTPS_REDIRECT=false
# CANONICAL_URL_ENFORCEMENT=false
# ERROR_DETAILS_ENABLED=true
# LOG_FORMAT=pretty
# LOG_LEVEL=debug
# COOKIE_SECURE=false
# COOKIE_SAMESITE=lax

# --- Staging/Production (Split Deployment) ---
# NODE_ENV=production
# CORS_ENABLED=true
# ALLOWED_ORIGINS=https://yourdomain.com
# FORCE_HTTPS_REDIRECT=true
# CANONICAL_URL_ENFORCEMENT=true
# ERROR_DETAILS_ENABLED=false
# LOG_FORMAT=json
# LOG_LEVEL=info
# COOKIE_SECURE=true
# COOKIE_SAMESITE=none
# SEO_META_ENABLED=true
# MONITORING_ENABLED=true
